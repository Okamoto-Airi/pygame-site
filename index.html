<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pygameサイト</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/style.css">
</head>

<body class="font-sans antialiased text-gray-800">

    <header id="main-header">
        <nav class="container mx-auto flex justify-between items-center">
            <img src="images/pygame.png" alt="Pygame Logo" class="h-10" />
            <div class="header-nav-links">
                <a href="#section1">ステージ1</a>
                <a href="#section2">ステージ2</a>
                <a href="#section3">ステージ3</a>
            </div>
        </nav>
    </header>

    <main>
        <section id="section1" class="dynamic-height-section">
            <img src="images/Blue-sky-and-grassland1.jpg" alt="Section 1 Background" class="section-background-image">
            <div class="content-wrapper">
                <div class="main-content-container">
                    <div class="text-content">
                        <h2>ステージ1</h2>
                        <p><span style="color: rgb(253, 134, 134);">左右</span>の矢印キーでキャラクターを移動し、
                            <span style="color: rgb(253, 134, 134);">スペースキー</span>で攻撃<br>敵の攻撃に3回当たるとゲームオーバー。
                            敵の攻撃は<span style="color: rgb(253, 134, 134);">相殺！</span><br>時間内にUFOを倒してゲームクリア</p>
                    </div>
                    <div class="video-player-container">
                        <video autoplay loop muted playsinline>
                            <source src="video/Level1.mp4" type="video/mp4">
                            あなたのブラウザは動画タグをサポートしていません。
                        </video>
                        <a href="https://okamoto-airi.github.io/web-pygame_level1_PC/" target="_blank"
                            class="play-button">
                            ステージ1をプレイ！（PC版）
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section id="section2" class="dynamic-height-section">
            <img src="images/Thunderclouds-and-lightning-on-the-grassland3.jpg" alt="Section 2 Background"
                class="section-background-image">
            <div class="content-wrapper">
                <div class="main-content-container">
                    <div class="text-content">
                        <h2>ステージ2</h2>
                        <p><span style="color: rgb(253, 134, 134);">上下</span>の矢印キーでキャラクターを移動し、
                            <span style="color: rgb(253, 134, 134);">スペースキー</span>で攻撃<br>敵の攻撃に3回当たるとゲームオーバー。
                            <span style="color: rgb(253, 134, 134);">相殺不可の攻撃</span><br>もあるので注意！
                            時間内にドラゴンを倒してゲームクリア！</p>
                    </div>
                    <div class="video-player-container">
                        <video autoplay loop muted playsinline>
                            <source src="video/Level2.mp4" type="video/mp4">
                            あなたのブラウザは動画タグをサポートしていません。
                        </video>
                        <a href="https://okamoto-airi.github.io/web-pygame_level2-PC/" target="_blank"
                            class="play-button">
                            ステージ2をプレイ！（PC版）
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section id="section3" class="dynamic-height-section">
            <img src="images/A-magical-otherworldly-space2.jpg" alt="Section 3 Background"
                class="section-background-image">
            <div class="content-wrapper">
                <div class="main-content-container">
                    <div class="text-content">
                        <h2>ステージ3</h2>
                        <p><span style="color: rgb(253, 134, 134);">上下左右の</span>矢印キーでキャラクターを移動し、
                            <span style="color: rgb(253, 134, 134);">WASD＋スペースキー</span>で攻撃<br>敵の攻撃に3回当たるとゲームオーバー。
                            <span style="color: rgb(253, 134, 134);">最高難易度</span>で最高評価クリアを目指せ！</p>
                    </div>
                    <div class="video-player-container">
                        <video autoplay loop muted playsinline>
                            <source src="video/Level3.mp4" type="video/mp4">
                            あなたのブラウザは動画タグをサポートしていません。
                        </video>
                        <a href="https://okamoto-airi.github.io/web-pygame_level3-PC/" target="_blank"
                            class="play-button">
                            ステージ3をプレイ！（PC版）
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 SIW チーム5 All rights reserved.</p>
    </footer>

    <a href="#" id="back-to-top-btn" class="float-animation">
        <p>上に<br>戻る</p>
        <img src="images/character_monster_slime_green.png" alt="上に戻る">
    </a>
    <script>
        // DOM（HTML）がすべて読み込まれてから実行される処理
        document.addEventListener('DOMContentLoaded', () => {
            const header = document.getElementById('main-header'); // 固定ヘッダーの要素を取得
            const sections = document.querySelectorAll('.dynamic-height-section'); // 高さを動的に調整するセクション群
            const backToTopBtn = document.getElementById('back-to-top-btn'); // 「トップへ戻る」ボタン

            function adjustLayout() {
                const headerHeight = header.offsetHeight; // ヘッダーの高さ

                // body に padding を設定してヘッダー分のスペースを確保
                document.body.style.paddingTop = `${headerHeight}px`;

                // 各セクションを個別に処理
                sections.forEach(section => {
                    const contentWrapper = section.querySelector('.content-wrapper');
                    if (contentWrapper) {
                        const contentHeight = contentWrapper.offsetHeight; // 中身の高さ
                        // 中身の高さに合わせつつ、ヘッダーが被らないようにする
                        section.style.minHeight = `${contentHeight + headerHeight}px`;
                        // ← 高さ固定ではなく minHeight にすることで伸縮に対応
                    }
                });
            }


                adjustLayout(); // ページ読み込み時に一度実行
                window.addEventListener('resize', adjustLayout);
                // 画面サイズが変わったときも再計算してレイアウトを更新

                // --- IntersectionObserverの設定（要素が画面内に入ったか監視する） ---
                const observerOptions = {
                    root: null,          // ビューポートを基準に監視
                    rootMargin: '0px',   // 余白なし
                    threshold: 0.5       // 要素が50%以上見えたときに「交差した」と判定
                };

                // 交差状態が変わったときのコールバック処理
                const observer = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        const contentWrapper = entry.target.querySelector('.content-wrapper');
                        // セクション内の .content-wrapper を取得

                        if (entry.isIntersecting) {
                            // 監視対象が50%以上見えたとき
                            if (contentWrapper) {
                                contentWrapper.classList.add('active'); // アニメーション開始用クラスを付与
                            }
                        } else {
                            // 監視対象が画面外に出たとき
                            if (contentWrapper) {
                                contentWrapper.classList.remove('active'); // クラスを削除（リセット）
                            }
                        }
                    });
                }, observerOptions);

                // 各セクションを監視対象に追加
                sections.forEach(section => {
                    observer.observe(section);
                });

                // --- ナビゲーションリンクをクリックしたときの処理 ---
                document.querySelectorAll('nav a').forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        e.preventDefault(); // デフォルトのリンク移動を無効化

                        const targetId = this.getAttribute('href'); // クリックしたリンクの href 属性を取得（例: "#section1"）
                        const targetElement = document.querySelector(targetId); // 対応する要素を取得

                        if (targetElement) {
                            // ヘッダーの高さを取得（スクロール位置の補正用）
                            const headerHeight = document.getElementById('main-header').offsetHeight;

                            // スクロール先の位置 = 対象要素の位置 - ヘッダー高さ
                            const targetPosition = targetElement.offsetTop - headerHeight;

                            // スムーズにスクロール
                            window.scrollTo({
                                top: targetPosition,
                                behavior: 'smooth'
                            });
                        }
                    });
                });

                // --- スクロール時に「トップへ戻る」ボタンを表示/非表示にする ---
                window.addEventListener('scroll', () => {
                    if (window.scrollY > 200) {
                        // スクロール量が200pxを超えたら表示
                        backToTopBtn.classList.remove('hidden');
                    } else {
                        // それ以下なら非表示
                        backToTopBtn.classList.add('hidden');
                    }
                });

                // --- 「トップへ戻る」ボタンをクリックしたときの処理 ---
                backToTopBtn.addEventListener('click', (e) => {
                    e.preventDefault(); // デフォルトのリンク動作を無効化

                    // ページ最上部へスムーズスクロール
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            });
    </script>

</body>

</html>